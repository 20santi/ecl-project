@app.route('/get_employee', methods=['GET', 'POST'])
def get_employee_detail():
    if request.method == 'POST':
        raw_names = request.form['name']
        name_list = [name.strip() for name in raw_names.split(',') if name.strip()]
        
        placeholders = ','.join(['?'] * len(name_list))

        conn = sqlite3.connect('employee.db')
        cursor = conn.cursor()
        cursor.execute(f"SELECT * FROM employees WHERE name IN ({placeholders})", name_list)
        employees = cursor.fetchall()
        conn.close()

        return render_template('show_employee.html', employees=employees, names=raw_names, searched=True)
    
    return render_template('show_employee.html', employees=None, names=None, searched=False)
    


<!-- @app.route('/get_employee', methods=['GET', 'POST'])
def get_employee_detail():
    result = None
    if request.method == 'POST':
        raw_input = request.form['name']
        search_terms = [term.strip() for term in raw_input.split(',') if term.strip()]

        if not search_terms:
            return render_template('show_employee.html', employees=[], names=raw_input, searched=True)

        conn = sqlite3.connect('employee.db')
        cursor = conn.cursor()

        result_set = {}
        leave_details_map = {}

        for term in search_terms:
            like_term = f"%{term}%"
            cursor.execute('''
                SELECT * FROM employees
                WHERE name LIKE ? OR email LIKE ? OR employee_id LIKE ?
                      OR phone LIKE ? OR address LIKE ?
            ''', (like_term, like_term, like_term, like_term, like_term))

            for row in cursor.fetchall():
                emp_id = row[0]

                if emp_id not in result_set:
                    result_set[emp_id] = row

                    # Get only the most recent leave record
                    cursor.execute('''
                        SELECT from_date, to_date, number_of_days, leave_type, leave_reason
                        FROM leave_requests
                        WHERE employee_id = ?
                        ORDER BY id DESC
                        LIMIT 1
                    ''', (emp_id,))
                    leave_row = cursor.fetchone()
                    print("leave details----------:::::: ",leave_row)
                    leave_details_map[emp_id] = [leave_row] if leave_row else []

        conn.close()

        employees = []
        for emp_id, row in result_set.items():
            leave_data = leave_details_map.get(emp_id, [])
            employees.append((row, leave_data))  # tuple of employee row and their last leave detail

        session['export_data'] = [emp[0] + ('',) for emp in employees]  # for Excel export

        return render_template('show_employee.html', employees=employees, names=raw_input, searched=True)

    return render_template('show_employee.html', employees=None, names=None, searched=False) -->
